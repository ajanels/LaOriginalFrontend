<div class="pwd-wrapper">
  <h2>Actualiza tu contraseña</h2>

  <!-- Contraseña actual -->
  <label class="field">
    Contraseña actual
    <div class="input-wrap">
      <input [(ngModel)]="current"
             [type]="showCurrent ? 'text' : 'password'"
             class="input" />
      <button type="button"
              class="icon-btn"
              (click)="showCurrent = !showCurrent"
              [attr.aria-label]="showCurrent ? 'Ocultar contraseña' : 'Mostrar contraseña'">
        <span class="material-icons">{{ showCurrent ? 'visibility_off' : 'visibility' }}</span>
      </button>
    </div>
  </label>

  <!-- Nueva contraseña + checklist -->
  <label class="field">
    Nueva contraseña
    <div class="input-wrap">
      <input [(ngModel)]="next"
             (input)="onNextInput()"
             [type]="showNext ? 'text' : 'password'"
             class="input"
             placeholder="Mín 8, mayúscula, minúscula, número y símbolo" />
      <button type="button"
              class="icon-btn"
              (click)="showNext = !showNext"
              [attr.aria-label]="showNext ? 'Ocultar contraseña' : 'Mostrar contraseña'">
        <span class="material-icons">{{ showNext ? 'visibility_off' : 'visibility' }}</span>
      </button>
    </div>

    <!-- Checklist estilo creación de usuario -->
    <ul class="pwd-checklist grid">
      <li class="item" [class.ok]="pwdRules.len">
        <span class="material-icons status">{{ pwdRules.len ? 'check_circle' : 'radio_button_unchecked' }}</span>
        8–64 caracteres
      </li>
      <li class="item" [class.ok]="pwdRules.upper">
        <span class="material-icons status">{{ pwdRules.upper ? 'check_circle' : 'radio_button_unchecked' }}</span>
        1 mayúscula
      </li>
      <li class="item" [class.ok]="pwdRules.lower">
        <span class="material-icons status">{{ pwdRules.lower ? 'check_circle' : 'radio_button_unchecked' }}</span>
        1 minúscula
      </li>
      <li class="item" [class.ok]="pwdRules.digit">
        <span class="material-icons status">{{ pwdRules.digit ? 'check_circle' : 'radio_button_unchecked' }}</span>
        1 número
      </li>
      <li class="item" [class.ok]="pwdRules.symbol">
        <span class="material-icons status">{{ pwdRules.symbol ? 'check_circle' : 'radio_button_unchecked' }}</span>
        1 símbolo
      </li>
    </ul>
  </label>

  <!-- Confirmación -->
  <label class="field">
    Confirmar nueva contraseña
    <div class="input-wrap">
      <input [(ngModel)]="confirm"
             [type]="showConfirm ? 'text' : 'password'"
             class="input" />
      <button type="button"
              class="icon-btn"
              (click)="showConfirm = !showConfirm"
              [attr.aria-label]="showConfirm ? 'Ocultar contraseña' : 'Mostrar contraseña'">
        <span class="material-icons">{{ showConfirm ? 'visibility_off' : 'visibility' }}</span>
      </button>
    </div>
  </label>

  <button class="btn" (click)="submit()">Cambiar</button>
</div>
